<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>WotV Accuracy Calculator | War of the Visions Accuracy Calculator</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="WotV Accuracy Calculator" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="War of the Visions Accuracy Calculator" />
<meta property="og:description" content="War of the Visions Accuracy Calculator" />
<link rel="canonical" href="https://whale-ofatime.github.io/WotVAccuracyCalculator/" />
<meta property="og:url" content="https://whale-ofatime.github.io/WotVAccuracyCalculator/" />
<meta property="og:site_name" content="WotV Accuracy Calculator" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="WotV Accuracy Calculator" />
<script type="application/ld+json">
{"headline":"WotV Accuracy Calculator","@type":"WebSite","description":"War of the Visions Accuracy Calculator","url":"https://whale-ofatime.github.io/WotVAccuracyCalculator/","name":"WotV Accuracy Calculator","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/WotVAccuracyCalculator/assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="/WotVAccuracyCalculator/assets/css/style.css">
  <script src="/WotVAccuracyCalculator/assets/js/bootstrap.bundle.min.js"></script><link type="application/atom+xml" rel="alternate" href="https://whale-ofatime.github.io/WotVAccuracyCalculator/feed.xml" title="WotV Accuracy Calculator" /></head><body><header class="site-header"><a class="site-title" rel="author" href="/WotVAccuracyCalculator/">WotV Accuracy Calculator</a>

  <!---->


  <!-- <div class="site-icon">
    <img src="assets/default-icon.png" />
  </div> -->

</header><main class="page-content" aria-label="Content">
        <div class="wrapper">
            <header class="post-header">
  <div class="row">
    <div class="col col-lg-10">
      <h1 class="post-title">WotV Accuracy Calculator</h1>
    </div>
    <div class="col col-lg-2 text-end">
      <span data-bs-toggle="modal" data-bs-target="#statueMasteryModal">
        <button type="button" class="btn btn-outline-secondary" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Statues & Masteries">
          <i class="bi bi-trophy" style="font-size: 1.5rem;"></i>
        </button>
      </span>
    </div>
  </div>
</header>

<div class="post-content">
  <div class="container">
    
    <div class="row justify-content-md-center">
      <div class="col col-lg-4">
        
        <!--Attacker-->
        <h1 class="display-1">Attacker</h1>
        <div class="mb-3">
          <img id="atkUnitImg" src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" style="width:250px;height:250px;object-fit:none;object-position: 50% 35%;"></i>
        </div>
        <select id="atkUnitDropdown" class="form-select mb-3" aria-label="attack-unit">
          <option selected disabled hidden>Choose Unit</option>
        </select>
        <div class="mb-3">
          <label for="atkDexInput" class="form-label">DEX</label>
          <input type="number" class="form-control" id="atkDexInput" placeholder=0>
        </div>
        <div class="mb-3">
          <label for="atkLukInput" class="form-label">LUK</label>
          <input type="number" class="form-control" id="atkLukInput" placeholder=0>
        </div>
        <select id="atkVCDropdown" class="form-select mb-3" aria-label="attack-vision-card">
          <option selected disabled hidden>Choose Vision Card</option>
        </select>
        <div id="accBase">-100</div>

      </div>
      <div class="col col-lg-3 pt-3">
        
        <!--Middle-->
        <h1 class="display-1 text-center"><span id="hitRate" >0</span>%</h1>

      </div>
      <div class="col col-lg-4">
        
        <!--Defender-->
        <h1 class="display-1">Defender</h1>
        <div class="mb-3">
          <img id="defUnitImg" src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" style="width:250px;height:250px;object-fit:none;object-position: 50% 35%;"></i>
        </div>
        <select id="defUnitDropdown" class="form-select mb-3" aria-label="defend-unit">
          <option selected disabled hidden>Choose Unit</option>
        </select>
        <div class="mb-3">
          <label for="defAgiInput" class="form-label">AGI</label>
          <input type="number" class="form-control" id="defAgiInput" placeholder=0>
        </div>
        <div class="mb-3">
          <label for="defLukInput" class="form-label">LUK</label>
          <input type="number" class="form-control" id="defLukInput" placeholder=0>
        </div>
        <select id="defVCDropdown" class="form-select mb-3" aria-label="defend-vision-card">
          <option selected disabled hidden>Choose Vision Card</option>
        </select>
        <div id="evaBase">-100</div>

      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="statueMasteryModal" tabindex="-1" aria-labelledby="statueMasteryModallLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content"  style="background-color: #212529">
      <div class="modal-header">
        <h5 class="modal-title" id="statueMasteryModalLabel">Guild Stone Statues & Elemental Masteries</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body py-4">
        <div class="row px-4">
          <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" role="switch" id="copyStatueMasterySwitch">
            <label class="form-check-label" for="copyStatueMasterySwitch">Apply same stats to both attacker and defender</label>
          </div>
        </div>
        <hr>
        <div class="row justify-content-md-center">
          <div class="col col-lg-4 d-flex justify-content-md-center">
            <h6>Attacker</h6>
          </div>
          <div class="col col-lg-4">
          </div>
          <div class="col col-lg-4 d-flex justify-content-md-center">
            <h6>Defender</h6>
        </div>
        <div class="row justify-content-md-center">
          <div class="col col-lg-3">
            <select id="atkBullStatue" class="form-select mb-3" aria-label="attack-bull-statue">
            </select>
          </div>
          <div class="col col-lg-6 d-flex justify-content-center align-items-center">
            <h6>Bull Stone Statue</h6>
          </div>
          <div class="col col-lg-3">
            <select id="defBullStatue" class="form-select mb-3" aria-label="defend-bull-statue">
            </select>
          </div>
        </div>
        <div class="row justify-content-md-center">
          <div class="col col-lg-3">
            <select id="atkLionStatue" class="form-select mb-3" aria-label="attack-lion-statue">
            </select>
          </div>
          <div class="col col-lg-6 d-flex justify-content-center align-items-center">
            <h6>Lion Stone Statue</h6>
          </div>
          <div class="col col-lg-3">
            <select id="defLionStatue" class="form-select mb-3" aria-label="defend-lion-statue">
            </select>
          </div>
        </div>
        <div class="row justify-content-md-center">
          <div class="col col-lg-3">
            <select id="atkKnightStatue" class="form-select mb-3" aria-label="attack-knight-statue">
            </select>
          </div>
          <div class="col col-lg-6 d-flex justify-content-center align-items-center">
            <h6>Knight Stone Statue</h6>
          </div>
          <div class="col col-lg-3">
            <select id="defKnightStatue" class="form-select mb-3" aria-label="defend-knight-statue">
            </select>
          </div>
        </div>
        <div class="row justify-content-md-center">
          <div class="col col-lg-3">
            <select id="atkElementMastery" class="form-select mb-3" aria-label="attack-element-mastery">
            </select>
          </div>
          <div class="col col-lg-6 d-flex justify-content-center align-items-center">
            <h6>Elemental Mastery</h6>
          </div>
          <div class="col col-lg-3">
            <select id="defElementMastery" class="form-select mb-3" aria-label="defend-element-mastery">
            </select>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="./assets/js/helper.js"></script>
<script type="text/javascript" src="./assets/js/wotvfunction.js"></script>

<script>
  function populateSelectDropdownWithNumbers(dropdownElementId, count) {
    let dropdown = document.querySelector(dropdownElementId);
    for (let i=1; i<=count; i++) {
      let option = document.createElement("option");
      option.value = i;
      option.text = i;
      dropdown.add(option, null);
    }
  }

  populateSelectDropdownWithNumbers('#atkBullStatue', 10);
  populateSelectDropdownWithNumbers('#defBullStatue', 10);
  populateSelectDropdownWithNumbers('#atkLionStatue', 10);
  populateSelectDropdownWithNumbers('#defLionStatue', 10);
  populateSelectDropdownWithNumbers('#atkKnightStatue', 10);
  populateSelectDropdownWithNumbers('#defKnightStatue', 10);
  populateSelectDropdownWithNumbers('#atkElementMastery', 40);
  populateSelectDropdownWithNumbers('#defElementMastery', 40);

  const copyStatueMasterySwitch = document.querySelector('#copyStatueMasterySwitch');
  const atkBullStatue = document.querySelector('#atkBullStatue');
  const defBullStatue = document.querySelector('#defBullStatue');
  const atkLionStatue = document.querySelector('#atkLionStatue');
  const defLionStatue = document.querySelector('#defLionStatue');
  const atkKnightStatue = document.querySelector('#atkKnightStatue');
  const defKnightStatue = document.querySelector('#defKnightStatue');
  const atkElementMastery = document.querySelector('#atkElementMastery');
  const defElementMastery = document.querySelector('#defElementMastery');

  copyStatueMasterySwitch.addEventListener('change', () => {
    if (copyStatueMasterySwitch.checked) {
      defBullStatue.disabled = true;
      defLionStatue.disabled = true;
      defKnightStatue.disabled = true;
      defElementMastery.disabled = true;
      defBullStatue.value = atkBullStatue.value;
      defLionStatue.value = atkLionStatue.value;
      defKnightStatue.value = atkKnightStatue.value;
      defElementMastery.value = atkElementMastery.value;
    }
    else {
      defBullStatue.disabled = false;
      defLionStatue.disabled = false;
      defKnightStatue.disabled = false;
      defElementMastery.disabled = false;
    }
  });

  atkBullStatue.addEventListener('change', () => {
    if (copyStatueMasterySwitch.checked) {
      defBullStatue.value = atkBullStatue.value;
    }
  });
  atkLionStatue.addEventListener('change', () => {
    if (copyStatueMasterySwitch.checked) {
      defLionStatue.value = atkLionStatue.value;
    }
  });
  atkKnightStatue.addEventListener('change', () => {
    if (copyStatueMasterySwitch.checked) {
      defKnightStatue.value = atkKnightStatue.value;
    }
  });
  atkElementMastery.addEventListener('change', () => {
    if (copyStatueMasterySwitch.checked) {
      defElementMastery.value = atkElementMastery.value;
    }
  });

  function getAccuracyBase(dex, luk) {
    if (dex < 0 || luk < 0) {
      return -100
    } else {
      return (11*(dex**0.2)/20 + (luk**0.96)/200 - 1)*100
    }
  }
  function getEvasionBase(agi, luk) {
    if (agi < 0 || luk < 0) {
      return -100
    } else {
      return (11*Math.pow(agi,0.9)/1000 + Math.pow(luk,0.96)/200 - 1)*100
    }
  }

  const atkDex = document.querySelector('#atkDexInput');
  const atkLuk = document.querySelector('#atkLukInput');
  const accBase = document.querySelector('#accBase');

  const defAgi = document.querySelector('#defAgiInput');
  const defLuk = document.querySelector('#defLukInput');
  const evaBase = document.querySelector('#evaBase');

  const hitRate = document.querySelector('#hitRate');

  function updateAccBase() {
    const acc = getAccuracyBase(Number(atkDex.value), Number(atkLuk.value)).toFixed(0);
    accBase.textContent = acc;
  }

  function updateEvaBase() {
    const eva = getEvasionBase(Number(defAgi.value), Number(defLuk.value)).toFixed(0);
    evaBase.textContent = eva;
  }

  function updateHitRate() {
    const hit = Number(accBase.textContent) - Number(evaBase.textContent);
    hitRate.textContent = hit;
  }

  atkDex.addEventListener('change', () => {updateAccBase(); updateHitRate();});
  atkLuk.addEventListener('change', () => {updateAccBase(); updateHitRate();});
  defAgi.addEventListener('change', () => {updateEvaBase(); updateHitRate();});
  defLuk.addEventListener('change', () => {updateEvaBase(); updateHitRate();});

  function loadUnitDropdown(dropdownElementId) {
    let namePromise = loadJSONPromise('./assets/dump/en/UnitName.json');
    namePromise.then((values) => {
      let nameList = values.infos
      let regex = /_P_/;
      let playerUnits = nameList.filter(unit => regex.test(unit.key));
      let sortedList = playerUnits.sort(dynamicSort("value"));
      let dropdown = document.querySelector(dropdownElementId);
      sortedList.forEach((unit) => {
        let option = document.createElement("option");
        option.value = unit.key;
        option.text = unit.value;
        dropdown.add(option, null);
      });
    });
  }

  loadUnitDropdown("#atkUnitDropdown");
  loadUnitDropdown("#defUnitDropdown");

  function loadVCDropdown(dropdownElementId) {
    let namePromise = loadJSONPromise('./assets/dump/en/VisionCardName.json');
    namePromise.then((values) => {
      let nameList = values.infos
      let regex = /_LW_/;
      let visionCards = nameList.filter(unit => regex.test(unit.key));
      let sortedList = visionCards.sort(dynamicSort("value"));
      let dropdown = document.querySelector(dropdownElementId);
      sortedList.forEach((unit) => {
        let option = document.createElement("option");
        option.value = unit.key;
        option.text = unit.value;
        dropdown.add(option, null);
      });
    });
  }

  loadVCDropdown("#atkVCDropdown");
  loadVCDropdown("#defVCDropdown");

  let atkUnitDropdown = document.querySelector("#atkUnitDropdown");
  let defUnitDropdown = document.querySelector("#defUnitDropdown");
  atkUnitDropdown.addEventListener('change', (event) => {
    updateStatsOnAtkUnitChange(event.target.value, '#atkDexInput', '#atkLukInput');
    updateImageOnUnitChange(event.target.value, '#atkUnitImg');
  });
  defUnitDropdown.addEventListener('change', (event) => {
    updateStatsOnDefUnitChange(event.target.value, '#defAgiInput', '#defLukInput');
    updateImageOnUnitChange(event.target.value, '#defUnitImg');
  });

  function updateImageOnUnitChange(unitKey, imageElementId) {
    let unitImageDirectory = "assets/dump/img/units/"
    let unitPromise = loadJSONPromise('./assets/dump/data/Unit.json');
    unitPromise.then((values) => {
      let data = parse_AnyData(values,"iname");
      let unit = data.get(unitKey);
      let regex = /_00/
      let fileName;
      if (regex.test(unit.voiceId) || !unit.hasOwnProperty('voiceId')) {
        fileName = unit.charaId;
      }
      else {
        // Handling for units with alternate costumes
        fileName = unit.voiceId;
      }
      let imageRef = unitImageDirectory + fileName + ".png"
      let image = document.querySelector(imageElementId);
      image.src = imageRef;
    });
  }

  function updateStatsOnAtkUnitChange(unitKey, dexInputElementId, lukInputElementId) {
    let statsPromise = getUnitLevelStats(unitKey);
    statsPromise.then((values) => {
      stats = values[values.length - 1]
      let dexInput = document.querySelector(dexInputElementId);
      let lukInput = document.querySelector(lukInputElementId);
      dexInput.value = stats.total.dex;
      lukInput.value = stats.total.luk;
      dexInput.dispatchEvent(new Event("change"));
      lukInput.dispatchEvent(new Event("change"));
    });
  }

  function updateStatsOnDefUnitChange(unitKey, agiInputElementId, lukInputElementId) {
    let statsPromise = getUnitLevelStats(unitKey);
    statsPromise.then((values) => {
      stats = values[values.length - 1]
      let agiInput = document.querySelector(agiInputElementId);
      let lukInput = document.querySelector(lukInputElementId);
      agiInput.value = stats.total.spd;
      lukInput.value = stats.total.luk;
      agiInput.dispatchEvent(new Event("change"));
      lukInput.dispatchEvent(new Event("change"));
    });
  }

  function updateStatsOnAtkVisionCardChange(vcKey, dexInputElementId, lukInputElementId) {
    console.log(vcKey);
    let statsPromise = getVisionCardLevelStats(vcKey);
    statsPromise.then((values) => {
      console.log(values);
    });
  }

  let atkVCDropdown = document.querySelector("#atkVCDropdown");
  atkVCDropdown.addEventListener('change', (event) => {updateStatsOnAtkVisionCardChange(event.target.value, '#atkDexInput', '#atkLukInput');});

</script>
        </div>
    </main><footer class="site-footer h-card">
    <data class="u-url" href="/WotVAccuracyCalculator/"></data>

    <div class="wrapper">

        <div class="footer">
            <div class="footer-title">2022 &copy; WotV Accuracy Calculator</div>

            <div class="footer-social-links">
                <a target="_blank" rel="me" href="https://github.com/SupunKavinda">
                    <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub icon</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
                </a>
                <a target="_blank" rel="me" href="https://twitter.com/_SupunKavinda">
                    <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Twitter icon</title><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"/></svg>
                    </a>
            </div>
        </div>
    </div>

</footer></body>

</html>